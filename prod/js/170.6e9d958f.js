"use strict";(self["webpackChunkvue_strategy_front_backend"]=self["webpackChunkvue_strategy_front_backend"]||[]).push([[170],{9206:function(e,l,o){o.d(l,{Z:function(){return t}});var n=o(3512);function t(){return(0,n.Z)({url:"/permission/list",method:"get"})}},7465:function(e,l,o){o.d(l,{F3:function(){return t},M3:function(){return a},yV:function(){return i}});var n=o(3512);function t(){return(0,n.Z)({url:"/role/list",method:"get"})}function i(e){return(0,n.Z)({url:`/role/permission/${e}`,method:"get"})}function a(e){return(0,n.Z)({url:"/role/distribute-permission",method:"post",data:e})}},5170:function(e,l,o){o.r(l),o.d(l,{default:function(){return h}});var n=o(3396),t=o(7139);const i={class:"role-list-container"};function a(e,l,o,a,r,s){const u=(0,n.up)("el-table-column"),d=(0,n.up)("el-button"),c=(0,n.up)("el-table"),p=(0,n.up)("el-card"),m=(0,n.up)("role-permission-dialog"),f=(0,n.Q2)("permission");return(0,n.wg)(),(0,n.iD)("div",i,[(0,n.Wm)(p,null,{default:(0,n.w5)((()=>[(0,n.Wm)(c,{data:a.roles,border:"",width:"100%"},{default:(0,n.w5)((()=>[(0,n.Wm)(u,{type:"index",label:e.$t("role.index"),width:"120"},null,8,["label"]),(0,n.Wm)(u,{label:e.$t("role.name"),prop:"title"},null,8,["label"]),(0,n.Wm)(u,{label:e.$t("role.desc"),prop:"describe"},null,8,["label"]),(0,n.Wm)(u,{label:e.$t("role.action"),width:"200"},{default:(0,n.w5)((({row:l})=>[(0,n.wy)(((0,n.wg)(),(0,n.j4)(d,{size:"small",type:"primary",onClick:e=>a.onRoleActionBtnClick(l)},{default:(0,n.w5)((()=>[(0,n.Uk)((0,t.zw)(e.$t("role.assignPermissions")),1)])),_:2},1032,["onClick"])),[[f,"distributePermission"]])])),_:1},8,["label"])])),_:1},8,["data"])])),_:1}),(0,n.Wm)(m,{modelValue:a.rolePermissionDialogVisible,"onUpdate:modelValue":l[0]||(l[0]=e=>a.rolePermissionDialogVisible=e),"role-id":a.selectedRoleId,onClose:a.onDialogClose},null,8,["modelValue","role-id","onClose"])])}var r=o(7465),s=o(4870),u=o(8676);const d={class:"dialog-footer"};function c(e,l,o,i,a,r){const s=(0,n.up)("el-tree"),u=(0,n.up)("el-button"),c=(0,n.up)("el-dialog"),p=(0,n.Q2)("loading");return(0,n.wg)(),(0,n.j4)(c,{title:e.$t("excel.roleDialogTitle"),"model-value":o.modelValue,onOpen:i.onDialogOpen,"append-to-body":"","open-delay":0,onClose:l[1]||(l[1]=l=>e.$emit("close"))},{footer:(0,n.w5)((()=>[(0,n._)("span",d,[(0,n.Wm)(u,{onClick:l[0]||(l[0]=l=>e.$emit("update:modelValue",!1))},{default:(0,n.w5)((()=>[(0,n.Uk)((0,t.zw)(e.$t("universal.cancel")),1)])),_:1}),(0,n.Wm)(u,{type:"primary",onClick:i.onDialogConfirm,loading:i.updating},{default:(0,n.w5)((()=>[(0,n.Uk)((0,t.zw)(e.$t("universal.confirm")),1)])),_:1},8,["onClick","loading"])])])),default:(0,n.w5)((()=>[(0,n.wy)((0,n.Wm)(s,{ref:"treeRef",data:i.permissions,"show-checkbox":"","check-strictly":"","node-key":"id","default-expand-all":"",props:i.defaultProps,"default-checked-keys":i.defaultCheckedKeys},null,8,["data","props","default-checked-keys"]),[[p,i.loading]])])),_:1},8,["title","model-value","onOpen"])}var p=o(9206),m=o(4329),f=o(2807),g={name:"role-permission-dialog",props:{modelValue:{type:Boolean,required:!0},roleId:{type:String,required:!0}},emits:["update:modelValue","close"],setup(e,{emit:l}){const o=(0,s.iH)([]),n=(0,s.iH)(!1),t=(0,s.iH)(),i=(0,m.QT)(),a=(0,s.iH)(!1),d=(0,s.iH)([]),c=(0,s.iH)([]);async function g(){try{n.value=!0,await(0,r.M3)({roleId:e.roleId,permissions:t.value.getCheckedKeys()}),f.z8.success(i.t("role.updateRoleSuccess")),l("update:modelValue",!1)}finally{n.value=!1}}async function y(){const e=await(0,p.Z)();d.value=e}async function v(){try{a.value=!0;const l=await(0,r.yV)(e.roleId);o.value=l,c.value=l.map((e=>{const l=e.split("-");return l[l.length-1]}))}finally{a.value=!1}}function w(){v()}return y(),(0,u.B)((()=>{y()})),{onDialogConfirm:g,onDialogOpen:w,rolePermissions:o,permissions:d,defaultProps:{children:"children",label:"permissionName"},defaultCheckedKeys:c,treeRef:t,loading:a,updating:n}}},y=o(89);const v=(0,y.Z)(g,[["render",c]]);var w=v,b={name:"role-list",components:{RolePermissionDialog:w},setup(){const e=(0,s.iH)([]),l=(0,s.iH)(""),o=(0,s.iH)(!1),n=(0,s.iH)(!1);async function t(){try{n.value=!0;const l=await(0,r.F3)();e.value=l}finally{n.value=!1}}function i(e){l.value=e.id,o.value=!0}function a(){l.value=""}return(0,u.B)((()=>{t()}),{immediate:!0}),{roles:e,selectedRoleId:l,onRoleActionBtnClick:i,rolePermissionDialogVisible:o,onDialogClose:a}}};const k=(0,y.Z)(b,[["render",a]]);var h=k}}]);
//# sourceMappingURL=170.6e9d958f.js.map